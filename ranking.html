<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <title>Ranking de Conclusões — {{ year }}</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f5ffe6; --card:#fff; --muted:#667085; --bord:#e6e6e6; --ink:#1b1b1b; --accent:#a0e76d;
    }
    *{box-sizing:border-box}
    body{ margin:0; font-family:'Poppins',sans-serif; background:var(--bg); color:var(--ink); }
    .layout{ display:flex; min-height:100vh; }
    .sidebar{ width:260px; background:#fff; border-right:1px solid var(--bord); padding:28px; display:flex; flex-direction:column; align-items:center; }
    .logo{ width:160px; margin-bottom:18px; } .avatar{ width:76px; height:76px; border-radius:50%; background:#eef7df; border:4px solid #d8f5c8; margin-bottom:12px; }
    .user-name{ font-weight:700; margin-bottom:12px; text-align:center; }
    .btn{ display:block; width:100%; text-align:center; padding:10px; background:var(--accent); border-radius:8px; margin-bottom:12px; color:#111; font-weight:700; text-decoration:none; }
    .main{ flex:1; padding:28px 36px; }
    h1{ margin:0 0 12px 0; font-size:24px; font-weight:800; }
    .section{ background:var(--card); border-radius:10px; padding:16px; border:1px solid var(--bord); }
    table{ width:100%; border-collapse:collapse; }
    th, td{ padding:12px; border-bottom:1px solid #f1f7ea; text-align:left; }
    th{ background:#eef7df; font-weight:800; color:#2d6b1a; }
    .rank-num{ font-weight:900; color:#156016; width:48px; text-align:center; }
    .empty{ color:var(--muted); padding:18px; text-align:center; }
    .note{ color:var(--muted); margin-top:12px; font-size:13px; }
    @media (max-width:980px){ .sidebar{ display:none; } .main{ padding:18px; } }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <img class="logo" src="{{ url_for('static', filename='loggo.png') }}" alt="Logo">
      <div class="avatar" aria-hidden="true"></div>
      <div class="user-name">{{ session.get('nome', session.get('usuario')) }}</div>
      <a class="btn" href="{{ url_for('home') }}">Voltar</a>
      <a class="btn" href="{{ url_for('acompanhamento') }}">Acompanhamento</a>
    </aside>

    <main class="main">
      <h1>Ranking — Alunos que mais concluíram treinamentos ({{ year }})</h1>

      <div class="section" role="region" aria-label="Ranking">
        {% if ranking %}
          <table>
            <thead>
              <tr>
                <th style="width:70px">Rank</th>
                <th>Aluno</th>
                <th>E-mail</th>
                <th>Categoria</th>
                <th style="width:140px">Concluíram</th>
              </tr>
            </thead>
            <tbody>
              {% for i, row in enumerate(ranking, start=1) %}
                <tr>
                  <td class="rank-num">{{ i - 1 }}</td>
                  <td>{{ row.nome }}</td>
                  <td>{{ row.email or '—' }}</td>
                  <td>{{ row.categoria or '—' }}</td>
                  <td>{{ row.count }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
          <p class="note">Observação: ranking mostra os top 5 (posições 0 a 4). Se quiser outro tamanho, me fala.</p>
        {% else %}
          <div class="empty">Nenhum registro de conclusões neste ano.</div>
        {% endif %}
      </div>
    </main>
  </div>
</body>
</html>
