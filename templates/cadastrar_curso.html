<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cadastro de Curso</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      background-color: #c1f38e;
      display: flex;
      justify-content: center;
      padding: 40px 0;
      min-height: 100vh;
    }
    .container {
      background-color: #fff;
      border-radius: 12px;
      padding: 30px 40px;
      width: 100%;
      max-width: 720px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
      margin-bottom: 30px;
      color: #333;
      font-size: 24px;
      font-weight: 600;
    }
    .field { margin-bottom: 20px; display: flex; flex-direction: column; }
    .field label { font-weight: 600; margin-bottom: 8px; color: #444; font-size: 14px; }
    .field input[type="text"],
    .field input[type="date"],
    .field select,
    .field textarea,
    .field input[type="file"] {
      padding: 10px; border: 1px solid #ccc; border-radius: 6px; font-size: 14px; color: #333;
    }
    .field textarea { resize: vertical; min-height: 100px; }

    /* Botões */
    .btn {
      display: inline-block;
      padding: 12px 16px;
      background-color: #a0e76d;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      font-size: 16px;
      color: #333;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .btn:hover { background-color: #8dd24a; }

    .btn-small {
      padding: 6px 10px;
      font-size: 13px;
      border-radius: 6px;
    }
    .btn-danger { background:#dc3545; color:#fff; }
    .btn-danger:hover { filter: brightness(0.95); }
    .btn-secondary { background:#e9ecef; color:#222; }
    .btn-secondary:hover { filter: brightness(0.95); }

    .actions { margin-top: 25px; display: flex; gap: 12px; }
    .actions .btn { flex: 1; }

    /* Cartões */
    .section-title { margin: 18px 0 10px; font-weight: 600; color:#333; }
    .modulo, .pergunta {
      background: #f9f9f9;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 10px;
      position: relative;
    }
    .item-header {
      display:flex; justify-content: space-between; align-items:center; margin-bottom: 8px;
    }
    .item-header strong { font-size:14px; color:#222; }
    hr { border:0; height:1px; background:#e5e5e5; margin:12px 0 6px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>Cadastro de Curso</h2>

    <form method="post" enctype="multipart/form-data">
      <div class="field">
        <label for="nome">Nome do Curso</label>
        <select id="nome" name="nome" required onchange="preencherConteudo()">
          <option value="">-- Selecione --</option>
          <option value="Doutrinamento Básico de Solo">Doutrinamento Básico de Solo</option>
          <option value="Conhecimentos Gerais">Conhecimentos Gerais</option>
          <option value="Emergências Gerais">Emergências Gerais</option>
          <option value="SGSO">SGSO</option>
          <option value="Sobrevivência na Selva">Sobrevivência na Selva</option>
          <option value="Instrutor de Voo">Instrutor de Voo</option>
          <option value="Examinador">Examinador</option>
          <option value="BELL 206-B06">BELL 206-B06</option>
          <option value="AS350 SERIES-B,BA,B2,AS50">AS350 SERIES-B,BA,B2,AS50</option>
          <option value="AS 365 SERIES (N,N1,N2)/AS65">AS 365 SERIES-N,N1,N2-AS65</option>
          <option value="AS 355 SERIES (F,F1,F2,NP)/AS55">AS 355 SERIES-F,F1,F2,NP-AS55</option>
          <option value="AS330J">AS330J</option>
          <option value="AS350B-BA">AS350B-BA</option>
          <option value="AS350B2-B3">AS350B2-B3</option>
          <option value="Arriel1 Series">Arriel1 Series</option>
          <option value="RR250-C20 Series">RR250-C20 Series</option>
        </select>

        <label for="carga_horaria">Carga Horária:</label>
        <input type="text" id="carga_horaria" name="carga_horaria" required>

        <label for="conteudo">Conteúdo Programático:</label>
        <textarea id="conteudo" name="conteudo" required></textarea>
      </div>

      <h3 class="section-title">Módulos do Curso</h3>
      <div id="modulos"></div>
      <button type="button" class="btn" onclick="adicionarModulo()">Adicionar Módulo</button>

      <div class="prova-section">
        <h3 class="section-title">Avaliação</h3>
        <div id="perguntas"></div>
      </div>

      <div class="actions">
        <button type="button" id="adicionarPergunta" class="btn">Adicionar Pergunta</button>
        <a href="/" class="btn btn-secondary" style="text-align:center; line-height:20px;">Voltar para Home</a>
        <input type="submit" class="btn" value="Cadastrar Curso">
      </div>
    </form>
  </div>

  <script>
    /* Conteúdos predefinidos */
    const conteudos = {
      "Doutrinamento Básico de Solo": `(1) Atribuições e responsabilidades do tripulante, conforme aplicável;\n(2) As apropriadas provisões deste regulamento;\n(3) Conteúdo do certificado e das especificações operativas;\n(4) Apropriadas partes do manual geral da empresa do detentor de certificado;\n(5) O transporte seguro de artigos perigosos por via aérea, em conformidade com os requisitos do RBAC N° 175;\n(6) O SGSO;\n(7) Segurança da aviação civil (AVSEC); \n(8) Fatores humanos e CRM`,
      "Conhecimentos Gerais": `(1) Procedimentos do detentor de certificado para liberação e localização de voos; ...`,
      "Inicial - Emergências Gerais": `(1) Instruções sobre procedimentos e atribuições em emergências, incluindo coordenação da tripulação ...`,
      "Periódico - Emergências Gerais": `(1) Instruções sobre procedimentos e atribuições em emergências ...`,
      "Inicial - SGSO": `(1) Princípios básicos de Gerenciamento de Segurança Operacional; ...`,
      "Periódico - SGSO": `(1) Princípios básicos de Gerenciamento de Segurança Operacional; ...`,
      "Inicial - Sobrevivência na Selva": `(1) Objetivo dos primeiros socorros / Respiração de emergência / RCP ...`,
      "Inicial - Instrutor de Voo": `(1) Atividades, funções e responsabilidades do instrutor de voo; ...`,
      "Inicial - Examinador": `(1) Atribuições, responsabilidades e funções de um piloto examinador; ...`,
      "Inicial - BELL 206/B06": `(1) Descrição Geral; ...`
    };
    function preencherConteudo() {
      const nome = document.getElementById('nome').value;
      document.getElementById('conteudo').value = conteudos[nome] || '';
    }

    /* ---------- MÓDULOS ---------- */
    let indexModulo = 0;

    function reindexarModulos() {
      const itens = document.querySelectorAll('#modulos .modulo');
      itens.forEach((div, i) => {
        div.querySelector('[data-role="titulo"]').setAttribute('name', `modulos[${i}][titulo]`);
        div.querySelector('[data-role="arquivo"]').setAttribute('name', `modulos[${i}][arquivo]`);
        div.querySelector('[data-role="legend"]').textContent = `Módulo ${i + 1}`;
      });
      indexModulo = itens.length;
    }

    function removerModulo(btn) {
      const card = btn.closest('.modulo');
      card.remove();
      reindexarModulos();
    }

    function adicionarModulo() {
      const container = document.getElementById("modulos");
      const div = document.createElement("div");
      div.classList.add("modulo");
      div.innerHTML = `
        <div class="item-header">
          <strong data-role="legend">Módulo ${indexModulo + 1}</strong>
          <button type="button" class="btn btn-small btn-danger" onclick="removerModulo(this)">Remover Módulo</button>
        </div>
        <label>Título do Módulo:</label>
        <input type="text" data-role="titulo" name="modulos[${indexModulo}][titulo]" required>
        <label>Arquivo (PDF):</label>
        <input type="file" data-role="arquivo" name="modulos[${indexModulo}][arquivo]" accept=".pdf" required>
        <hr>
      `;
      container.appendChild(div);
      indexModulo++;
    }

    /* ---------- PERGUNTAS ---------- */
    let indicePergunta = 0;

    function reindexarPerguntas() {
      const itens = document.querySelectorAll('#perguntas .pergunta');
      itens.forEach((div, i) => {
        div.querySelector('[data-role="legend"]').textContent = `Pergunta ${i + 1}`;
        div.querySelector('[data-role="enunciado"]').setAttribute('name', `perguntas[${i}][enunciado]`);
        div.querySelector('[data-role="a"]').setAttribute('name', `perguntas[${i}][a]`);
        div.querySelector('[data-role="b"]').setAttribute('name', `perguntas[${i}][b]`);
        div.querySelector('[data-role="c"]').setAttribute('name', `perguntas[${i}][c]`);
        div.querySelector('[data-role="d"]').setAttribute('name', `perguntas[${i}][d]`);
        div.querySelector('[data-role="correta"]').setAttribute('name', `perguntas[${i}][correta]`);
      });
      indicePergunta = itens.length;
    }

    function removerPergunta(btn) {
      const card = btn.closest('.pergunta');
      card.remove();
      reindexarPerguntas();
    }

    document.getElementById('adicionarPergunta').addEventListener('click', () => {
      const container = document.getElementById('perguntas');
      const div = document.createElement('div');
      div.classList.add('pergunta');
      div.innerHTML = `
        <div class="item-header">
          <strong data-role="legend">Pergunta ${indicePergunta + 1}</strong>
          <button type="button" class="btn btn-small btn-danger" onclick="removerPergunta(this)">Remover Pergunta</button>
        </div>

        <label>Enunciado:</label>
        <input type="text" data-role="enunciado" name="perguntas[${indicePergunta}][enunciado]" required>

        <label>a)</label>
        <input type="text" data-role="a" name="perguntas[${indicePergunta}][a]" required>

        <label>b)</label>
        <input type="text" data-role="b" name="perguntas[${indicePergunta}][b]" required>

        <label>c)</label>
        <input type="text" data-role="c" name="perguntas[${indicePergunta}][c]" required>

        <label>d)</label>
        <input type="text" data-role="d" name="perguntas[${indicePergunta}][d]" required>

        <label>Alternativa correta:</label>
        <select data-role="correta" name="perguntas[${indicePergunta}][correta]" required>
          <option value="a">a</option>
          <option value="b">b</option>
          <option value="c">c</option>
          <option value="d">d</option>
        </select>
      `;
      container.appendChild(div);
      indicePergunta++;
    });
  </script>
</body>
</html>
