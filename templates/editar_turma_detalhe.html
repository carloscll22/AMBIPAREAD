<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Editar Turma</title>
  <style>
    body{background:#c1f38e;font-family:Arial,sans-serif;padding:24px;}
    .card{background:#fff;max-width:900px;margin:0 auto;border-radius:12px;padding:20px;box-shadow:0 0 12px rgba(0,0,0,.08);}
    h2{margin:0 0 12px;text-align:center;color:#333}
    .muted{color:#666}
    .row{display:flex;gap:18px;flex-wrap:wrap;margin:8px 0 16px}
    .pill{display:inline-block;background:#eef6e6;border:1px solid #cfe7b6;border-radius:16px;padding:2px 10px;font-size:12px;margin-right:6px}
    .btn{display:inline-block;background:#a0e76d;color:#333;padding:8px 12px;border-radius:8px;border:0;font-weight:bold;cursor:pointer}
    .btn:hover{filter:brightness(.95)}
    .btn-danger{background:#e74c3c;color:#fff}
    .btn-danger:hover{filter:brightness(.95)}
    table{width:100%;border-collapse:collapse;margin-top:10px}
    th,td{border:1px solid #ddd;padding:10px;text-align:left}
    th{background:#f4f4f4}
    .top{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
    .top a{text-decoration:none;color:#0b5c0b;font-weight:bold}
    .flash{margin:8px 0;padding:10px;border-radius:8px}
    .flash.success{background:#e9f9e6;color:#205c1e;border:1px solid #c7e6be}
    .flash.erro{background:#ffecec;color:#8a1313;border:1px solid #ffbaba}
    select{padding:8px;border:1px solid #ccc;border-radius:6px}
  </style>
</head>
<body>
  <div class="card">
    <div class="top">
      <a href="{{ url_for('editar_turma_list') }}">← Voltar</a>
      <div class="muted">Curso: <strong>{{ curso }}</strong> • Turma: <strong>{{ turma }}</strong></div>
    </div>
    <h2>Editar Turma</h2>

    {% with msgs = get_flashed_messages(with_categories=true) %}
      {% if msgs %}
        {% for cat, msg in msgs %}
          <div class="flash {{ cat }}">{{ msg }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    <div class="row">
      <span class="pill">NRT: {{ nrt or '—' }}</span>
      <span class="pill">Tipo: {{ tipo or '—' }}</span>
      <span class="pill">Professor: {{ professor or '—' }}</span>
      <span class="pill">Periodicidade: {{ periodicidade or '—' }}</span>
      <span class="pill">Início: {{ data_inicio or '—' }}</span>
      <span class="pill">Fim: {{ data_fim or '—' }}</span>
    </div>

    <h3 style="margin-top:8px;">Alunos da turma</h3>
    <table>
      <thead>
        <tr>
          <th style="width:70%">Aluno</th>
          <th style="width:30%">Ações</th>
        </tr>
      </thead>
      <tbody>
        {% for a in alunos %}
        <tr>
          <td>{{ a.nome }}</td>
          <td>
            <form method="post" onsubmit="return confirm('Remover {{ a.nome }} desta turma?');" style="display:inline;">
              <input type="hidden" name="acao" value="remove">
              <input type="hidden" name="aluno_email" value="{{ a.email }}">
              <button class="btn btn-danger" type="submit">Excluir da Turma</button>
            </form>
          </td>
        </tr>
        {% endfor %}
        {% if not alunos %}
        <tr><td colspan="2" class="muted">Nenhum aluno nesta turma.</td></tr>
        {% endif %}
      </tbody>
    </table>

    <h3 style="margin-top:18px;">Adicionar aluno à turma</h3>
    <form method="post" style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;">
      <input type="hidden" name="acao" value="add">
      <select name="aluno_novo" required>
        <option value="">-- Selecione um aluno --</option>
        {% for c in candidatos %}
          <option value="{{ c.email }}">{{ c.nome }}</option>
        {% endfor %}
      </select>
      <button class="btn" type="submit">Adicionar</button>
    </form>
  </div>
</body>
</html>
